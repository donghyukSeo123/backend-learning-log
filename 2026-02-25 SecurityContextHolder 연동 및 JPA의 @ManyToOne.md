2026-02-25 – 데이터 영속화 고도화: SecurityContextHolder와 Entity 매핑
오늘 한 것
SecurityContextHolder 연동: 인증된 사용자의 정보를 전역적으로 관리하는 SecurityContextHolder를 활용하여 요청별 유저 식별 로직 구현.

연관관계 기반 데이터 저장 로직 완성: Project 엔티티와 User 엔티티를 매핑하여 생성된 프로젝트가 로그인한 사용자에게 귀속되도록 서비스 레이어 구축.

정적 팩토리 메서드(from) 패턴 적용: DTO 생성 시 new 키워드 대신 static 메서드를 사용하여 객체 생성 의도를 명확히 하고 가독성을 향상시킴.

JPA 필드 초기화 및 Builder 설정: DB의 DEFAULT 설정이 무시되는 현상을 방지하기 위해 @Builder.Default를 통한 status 필드 초기값 고정.

오늘 알게 된 것
SecurityContextHolder: ThreadLocal을 기반으로 동작하여 각 요청 스레드마다 독립적인 보안 장부를 관리하며, @AuthenticationPrincipal로 이를 간편하게 호출하는 원리.

정적 메서드 vs 생성자: static 메서드는 클래스 수준에서 호출되며, new를 통한 객체 생성보다 "어디로부터(from)" 생성되었는지 의도를 명확히 전달한다는 점.

JPA Null 저장 이슈: 엔티티 필드가 null이면 DB의 기본값이 무시되고 null이 명시적으로 저장되므로, 자바 단에서 초기값을 설정하는 것이 안전하다는 점.

데이터 귀속의 중요성: 외래 키(FK) 매핑을 통해 데이터의 소유권을 확립해야 향후 '내 프로젝트 목록 조회'와 같은 비즈니스 로직이 가능하다는 점.

🧠 오늘의 개념
🛡️ SecurityContextHolder (보안 컨텍스트 저장소)
목적: 현재 실행 중인 스레드 내에서 인증된 사용자 정보를 보관하고 공유함.

작동 원리: 인증 필터에서 검증된 UserPrincipal을 장부(Context)에 등록하여 컨트롤러나 서비스 어디서든 현재 유저 정보를 꺼내 쓸 수 있게 함.

🏗️ 정적 팩토리 메서드 (from 메서드)
정의: 클래스 내부에 static으로 정의된 객체 생성 전용 메서드.

활용: ProjectResponseDto.from(project)와 같이 명명하여 객체 변환의 의미를 코드에 담음. new 키워드와 함께 사용할 수 없는 문법적 특성을 가짐.

🔗 데이터 귀속 및 연관관계 매핑
정의: 비즈니스 데이터가 생성될 때 이를 소유한 사용자(User)와의 관계를 설정하는 작업.

방법: JPA의 @ManyToOne 관계를 활용하여 엔티티 저장 시 유저 객체를 함께 넣어줌으로써 DB의 외래 키(user_id)를 자동으로 할당함.

⚠️ JPA @Builder.Default
목적: 빌더 패턴을 사용할 때 특정 필드에 자바 단의 기본값을 강제로 할당하기 위함.

활용: status 필드를 "Y"로 초기화하여 프론트엔드에서 데이터가 누락되어도 시스템 기본값이 유지되도록 보장함.

📌 요약
SecurityContextHolder를 통해 로그인한 사용자의 정보를 세션처럼 자유롭게 활용하는 기반을 닦았고, 프로젝트 데이터가 사용자에게 정확히 귀속되도록 처리함.

이제 컨텐츠메이커스튜디오는 사용자 권한 식별과 데이터 소유권 관리가 가능한 안정적인 백엔드 데이터 파이프라인을 갖추게 됨.
